---
title: "The Effects of Stigmatization on Stress and Emotions"
author: "mel"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    fig_width: 10
    fig_height: 6

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(stringr)
library(knitr)
library(ggplot2)
library(showtext)
library(devtools)

```
## Background: 

# Research Question: 
Does stigma function as a moderator in the relationship between perceived stress and emotional valence (positive or negative affect) experienced by individuals?

# Study Design
Perceived Stress: 1(not stressed)-5(very stressed)
  Outcome Variable
  Continuous: 
  
Emotional Valence: 1(negative)-9(positive)
  Outcome Variable
  Continuous
  
Condition: condition 1:non-stigmatized, 2= stigmatized
  Predictor Variable
  Categorical

Between-Subject Design
# Predicted Results:
The interaction between perceived stress, stigma, and emotional valence is expected to be significant. Participants facing high stigma are predicted to have high perceived stress and lowest emotional valence (most negative affect) compared to other group. 


## Load Data
```{r load}
data <- read.csv("data/data processing script /STGREW1b_comb.csv")
```

## Reverse Code Perveived Stress 
```{r recode}
#recode 2 varibles Pss: Q2_2, Q2_3
data <- data %>% 
  mutate_at(vars(Q2_2, Q2_3), function(x){6-x})
```
## Average and Create A Column for Percieved Stress
```{r pss col}
# make one col of pss/ average rows four items t create one single pss col
data <- data %>% 
  rowwise() %>% 
  mutate(PSS = mean(c_across(starts_with('Q2_')), na.rm = TRUE))

```
## Format Condition to Catergorical
```{r condition col}
# condition col / get condition varibale in right format / need to be in factors (categorical)
data$Condition <- factor(data$Condition,
                          levels=c(1,2),
                          labels=c("Control","Stigma"))
data$Condition <- as.factor(data$Condition)
```
## Descriptives of Condition

```{r}
sum(data$Condition == "Control")
sum(data$Condition == "Stigma")
```
## Descriptives of Emotional Valence 
```{r desc emotional valence}
c(summary(data$mat_valence),"SD"=sd(data$mat_valence,na.rm=T))
```
## Descriptives of Percieved Stress
```{r desc percieved stress}
c(summary(data$PSS),"SD"=sd(data$PSS,na.rm=T))
```
## Create a Linear Regression Model
```{r linear model}
# lm formula
model <- lm(mat_valence ~  Condition * PSS, data)

#see what output is
 summary (model)

```
## Create Linear Regression Model Graph 
```{r ggplot 0}
plot <- ggplot(data, aes(x= PSS, y=mat_valence, color=Condition)) +
  geom_point() +
  geom_smooth(method = "lm", se = T, alpha = .2) +
  labs(x="Perceived Stress", y="Emotional Valence") 

plot
```

```{r ggplot

theme_name = "theme_barbie" # Pick which theme you want

theme_url = paste0("https://raw.githubusercontent.com/MatthewBJane/theme_park/main/", theme_name ,".R")
source_url(theme_url)

plot <- ggplot(data, aes(x= PSS, y=mat_valence, color=Condition)) +
  geom_point() +
  geom_smooth(method = "lm", se = T, alpha = .2) +
  labs(x="Perceived Stress", y="Emotional Valence") +
  theme_barbie(barbie_font = TRUE) +
  scale_color_manual(values=c(light_color_barbie,dark_color_barbie)) 
  

plot

## Results
The interaction between stigma and perceived stress on emotional valence was not significant. This finding was not aligned with our hypothesis could be due to an inadequate sample size or there is no relationship with stigma and stress.
 